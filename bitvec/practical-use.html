<!DOCTYPE HTML>
<html lang="en-US" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Practical Use - A User’s Guide to the Ferrilab Project</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="A more thorough exploration of Ferrilab’s crates.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././guide/assets/mdbook-admonish.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../dedication.html">Dedication</a></li><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction to Ferrilab</a></li><li class="chapter-item expanded "><a href="../radium.html"><strong aria-hidden="true">2.</strong> Radium</a></li><li class="chapter-item expanded "><a href="../funty.html"><strong aria-hidden="true">3.</strong> funty</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../funty/permission-changes.html"><strong aria-hidden="true">3.1.</strong> Permission Changes</a></li></ol></li><li class="chapter-item expanded "><a href="../bitvec.html"><strong aria-hidden="true">4.</strong> bitvec</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bitvec/data-structures.html"><strong aria-hidden="true">4.1.</strong> Data Structures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bitvec/data-structures/bitslice.html"><strong aria-hidden="true">4.1.1.</strong> BitSlice</a></li><li class="chapter-item expanded "><a href="../bitvec/data-structures/bitarray.html"><strong aria-hidden="true">4.1.2.</strong> BitArray</a></li><li class="chapter-item expanded "><a href="../bitvec/data-structures/bitvec.html"><strong aria-hidden="true">4.1.3.</strong> BitVec and BitBox</a></li></ol></li><li class="chapter-item expanded "><a href="../bitvec/type-parameters.html"><strong aria-hidden="true">4.2.</strong> Type Parameters</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bitvec/type-parameters/bitorder.html"><strong aria-hidden="true">4.2.1.</strong> BitOrder</a></li><li class="chapter-item expanded "><a href="../bitvec/type-parameters/bitstore.html"><strong aria-hidden="true">4.2.2.</strong> BitStore</a></li></ol></li><li class="chapter-item expanded "><a href="../bitvec/practical-use.html" class="active"><strong aria-hidden="true">4.3.</strong> Practical Use</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bitvec/practical-use/collections.html"><strong aria-hidden="true">4.3.1.</strong> bool Collections</a></li><li class="chapter-item expanded "><a href="../bitvec/practical-use/bitfields.html"><strong aria-hidden="true">4.3.2.</strong> C-Style Bitfields</a></li></ol></li><li class="chapter-item expanded "><a href="../bitvec/memory-representation.html"><strong aria-hidden="true">4.4.</strong> Memory Representation</a></li><li class="chapter-item expanded "><a href="../bitvec/memory-model.html"><strong aria-hidden="true">4.5.</strong> Memory Model</a></li><li class="chapter-item expanded "><a href="../bitvec/performance.html"><strong aria-hidden="true">4.6.</strong> Performance</a></li><li class="chapter-item expanded "><a href="../bitvec/pointer-encoding.html"><strong aria-hidden="true">4.7.</strong> Pointer Encoding</a></li><li class="chapter-item expanded "><a href="../bitvec/miscellaneous.html"><strong aria-hidden="true">4.8.</strong> Other Features</a></li></ol></li><li class="chapter-item expanded "><a href="../afterword.html">Afterword</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">A User’s Guide to the Ferrilab Project</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ferrilab/ferrilab" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="practical-use"><a class="header" href="#practical-use">Practical Use</a></h1>
<p>That’s enough theory; let’s talk about how to use the crate. This chapter is
divided into two subsections, one for use cases that want an ordinary <code>bool</code>
collection library with transparent memory compaction, and one for use cases
that want a convenient way to precisely sculpt memory. Before getting in to
either, let’s quickly recap how the <code>bitvec</code> types interact with memory
ownership.</p>
<h2 id="rustic-memory-management"><a class="header" href="#rustic-memory-management">Rustic Memory Management</a></h2>
<p>The first and most important thing to remember is that, despite the extra
complexity just discussed about memory parameters and aliasing behavior,
<code>bitvec</code> is <em>just Rust</em>. It obeys all of the rules and patterns that the rest of
Rust does.</p>
<p><code>BitSlice</code>s, like regular slices, are exclusively borrowed from owned memory
higher up the call stack. Their references can be passed down the stack, and are
subject to the same lifetime and mutation-exclusivity rules.</p>
<p>The owned memory that creates a <code>BitSlice</code> view can be an array, boxed slice, or
vector of either ordinary integers, or their wrapper equivalents provided by
<code>bitvec</code>:</p>
<pre><code class="language-rust">use bitvec::prelude::*;

let array = [0u8; 8];
let boxed: Box&lt;[u16]&gt; = Box::new([0u16; 4]);
let vec = vec![0u32; 2];

let bits_a = bitarr![u8, Msb0; 0; 64];
let bits_b = bitbox![u16, Lsb0; 0; 64];
let bits_v = bitvec![u32, LocalBits; 0; 32];</code></pre>
<p>Once memory is bound, it can be borrowed as a <code>BitSlice</code> by using the <code>BitView</code>
trait (imported in the prelude), or by using the fact that all <code>bitvec</code>
containers borrow themselves as <code>BitSlices</code> just like standard-library
containers borrow themselves as slices:</p>
<pre><code class="language-rust"><span class="boring">use bitvec::prelude::*;
</span><span class="boring">let array = [0u8; 8];
</span><span class="boring">let boxed: Box&lt;[u16]&gt; = Box::new([0u16; 4]);
</span><span class="boring">let vec = vec![0u32; 2];
</span><span class="boring">let bits_a = bitarr![u8, Msb0; 0; 64];
</span><span class="boring">let bits_b = bitbox![u16, Lsb0; 0; 64];
</span><span class="boring">let bits_v = bitvec![u32, LocalBits; 0; 32];
</span>let array_bits = array.view_bits::&lt;Msb0&gt;();
let boxed_bits = boxed.view_bits::&lt;Lsb0&gt;();
let vec_bits = vec.view_bits::&lt;LocalBits&gt;();

let bits_a_ref: &amp;BitSlice&lt;_, _&gt; = &amp;bits_a;
let bits_b_ref: &amp;BitSlice&lt;_, _&gt; = &amp;bits_b;
let bits_c_ref: &amp;BitSlice&lt;_, _&gt; = &amp;bits_c;</code></pre>
<blockquote>
<p>And, of course, mutability applies:</p>
<pre><code class="language-rust">let mut arr = bitarr![0; 10];
let arr_ref: &amp;mut BitSlice = &amp;mut arr;
arr_ref.set(1, true);
assert!(arr_ref[1]);</code></pre>
</blockquote>
<p>Just as with ordinary Rust code, <code>BitSlice</code> is the type you want to use when
working with memory that you are not responsible for moving around or
destroying. However, when you do need to move memory around, you need to switch
to either a <code>static</code> binding or a container: <code>BitArray</code> is always available, and
<code>BitBox</code> and <code>BitVec</code> require an allocator.</p>
<p>I am spending this much time discussing the Rust memory management system
because this is a <em>very</em> common question I receive. No other bit-stream crate
has reference types, and therefore users coming from, e.g., <code>bit-vec</code> see the
same <code>BitSlice</code> name and attempt to use their habits from that crate.</p>
<p><code>bitvec</code> is not like any other bitstream library, in Rust, C++, or another
language. <code>bitvec</code> is like ordinary Rust. I promise.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../bitvec/type-parameters/bitstore.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../bitvec/practical-use/collections.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../bitvec/type-parameters/bitstore.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../bitvec/practical-use/collections.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
